---
title: "Plots for the main paper"
output: pdf_document
---

```{r setup, message=FALSE, echo=FALSE}
knitr::opts_chunk$set(echo = FALSE)
library(ggplot2)
library(dplyr)
library(tidyr)
library(tibble)
library(cowplot) #Optional, can be commented out
library(knitr)
library(here)
library(readxl)

temp_dir <- "local_temp_data"
if(!dir.exists(temp_dir)) {
  dir.create(temp_dir)
}
```

```{r}
luciferase_file <- here("private_data", "190603 for martin.xlsx")
luciferase_data <-  read_excel(luciferase_file, sheet = "Nanoluc-20 hours-mammals", range = "A2:B100")
names(luciferase_data) <- c("Condition", "Activity")

luciferase_data <- luciferase_data %>%
  filter(Condition != "") %>%
  separate(Condition, into = c("Animal_raw", "Binding"), sep = " ") %>%
  mutate(Animal = factor(Animal_raw, levels = c("mouse","pig","cow"), labels = c("Mouse","Porcine","Bovine")))
```


```{r, fig.height=4, fig.width=6}
luciferase_plot <- luciferase_data %>%
  ggplot(aes(x = Binding, y = Activity, color = Binding, shape = Binding)) +
  stat_summary(geom = "errorbar", fun.data = "mean_se", width = 0.5) +
  stat_summary(geom = "errorbar", fun.y = "mean", aes(ymax = ..y.., ymin = ..y..), color = "black") +
  geom_point(position = position_jitter(width = 0.25)) +
  scale_color_manual(values = c("#405b74", "#ff0000", "#a5a5a5")) +
  theme(axis.text.x = element_text(angle = 90, hjust = 1, vjust = 0.5)) +
  facet_wrap(~Animal) +
  guides(color = guide_legend(override.aes = list(alpha = 1, linetype = 0))) + 
  expand_limits(y = 0) + scale_y_continuous(expand = expand_scale(mult = c(0, .05)))


luciferase_plot
```

```{r}
luciferase_width = 6
luciferase_height = 4
for(type in c(".png",".svg")) {
  ggsave(paste0(temp_dir,"/luciferse", type), luciferase_plot, width = luciferase_width, height = luciferase_height)
}

```

